You are given TWO images and ONE text prompt.

IMAGE 1 (Input Image):
- Original image with user-drawn visual instructions.

IMAGE 2 (Output Image):
- Image generated by the model after editing IMAGE 1.
- The output may be cropped or reframed.

TEXT PROMPT:
- {prompt}

Your task is to evaluate Contextual Preservation.

Definition:
Contextual Preservation checks whether the model changed anything it was NOT supposed to change.
It does NOT judge whether the edit was correct, precise, or well aligned.
Errors in edit location, extent, or alignment belong to Instruction Adherence, not Contextual Preservation.

Evaluation rules (follow strictly):

1) Cropping rule  
- If the output is cropped, only compare the overlapping visible region.
- Ignore content missing only due to cropping.

2) Difference listing (what counts as a difference)
- List ONLY meaningful differences at the level of objects or semantic entities.
- Do NOT list differences caused by:
  • minor blur or softness,
  • small texture or color shifts,
  • pixel-level noise,
  • slight position or alignment offsets.
- A difference should be listed ONLY if it:
  • adds or removes a complete object,
  • changes the identity of an object,
  • or damages the structural integrity of a non-target object.

3) Target rule  
- Identify the intended edit target based ONLY on:
  (a) the visual instruction marks, and
  (b) the text prompt.

4) Classification rule  
- IN_TARGET:
  • any change within the intended target,
  • OR any imperfect attempt to edit the target
    (including misplacement, offset, scale error, or incomplete coverage).
- OUT_OF_TARGET:
  • any change to unrelated objects or regions,
  • any addition or removal of unrelated semantic entities,
  • any structural damage to non-target objects.

5) Scoring  
- Score = 1 if NO OUT_OF_TARGET differences exist.
- Score = 0 if ANY OUT_OF_TARGET difference exists.
- If unsure, score = 0.

Output format:
First provide a brief analysis with these sections:
- ## Differences
- ## Target
- ## Classification
- ## Decision

Then output the final JSON as the last part of your response:

{
  "Contextual_Preservation": {
    "reason": "string",
    "score": 0
  }
}
